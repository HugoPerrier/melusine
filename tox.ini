[tox]
requires =
    tox>=4
env_list = clean, core38, core310, transformers

[gh-actions]
python =
  3.8: clean, core38, transformers
  3.10: core310

[testenv]
commands = pytest --cov --cov-append --cov-report=term-missing
deps =
    pytest
    pytest-cov
depends =
    {core38,transformers}: clean

[testenv:core38]
deps={[testenv]deps}
commands={[testenv]commands}

[testenv:core310]
deps={[testenv]deps}
commands=pytest tests

[testenv:clean]
deps = coverage
skip_install = true
commands = coverage erase

;[testenv:report]
;deps = coverage
;skip_install = true
;commands =
;    coverage report
;    coverage html

;[testenv:deps]
;description = run unit tests for optional dependency factory
;deps =
;    pytest>=7
;commands = pytest tests/factory
;extras = misc

[testenv:transformers]
description = run unit tests with the transformers dependency
deps={[testenv]deps}
commands = pytest tests/huggingface --cov --cov-append --cov-report=term-missing
extras = transformers
